# ctl-results
Results of Cyber Test Lab analysis

## Caveat hackor

We've now posted a complete analysis run of the [Fedora 27 packages](https://github.com/fedoraredteam/ctl-results/tree/master/fedora/27). The [CTL](https://github.com/fedoraredteam/cyber-test-lab) code is still alpha.

We have the two following convictions about our results:
1. They're wrong
2. They will get better

This will be an iterative process. We're still immature, but this project is being actively improved.

## Fedora 27 complexity analysis

Here's a sample of the data collected by this project.

![afcc](https://github.com/fedoraredteam/ctl-results/raw/master/afCc.png)

This graph shows the [cyclomatic complexity](https://blog.jasoncallaway.com/2017/09/19/measuring-cyclomatic-complexity-with-radare2/) values for all Fedora 27 binaries (for which the CTL code cooperated, we have a [bug](https://github.com/fedoraredteam/cyber-test-lab/issues/1) there). The histogram represents a probability density function indiciating the liklihood that a complexity value will fall in that range. We see that most Fedora 27 binaries have a cyclomatic complexity of less than 100, with a mean of about 35. Some binaries are much more complex, the highest in this dataset being 780. Note that we currently [time out](https://github.com/fedoraredteam/cyber-test-lab/blob/master/cybertestlab/CyberTestLab.py#L188) `r2` after 10 minutes of trying to analyze the binary (`aa` command). As a result, there are many cyclomatic complexity values higher than 780 in the Fedora 27 repositories. We're tracking a [bug](https://github.com/fedoraredteam/cyber-test-lab/issues/6) for that too.

So what does this mean? We won't know for sure until we graduate from this static analysis to dynamic analysis in the form of fuzzing. (For an introduction to fuzzing, the [Sully manual](http://www.fuzzing.org/wp-content/SulleyManual.pdf) is excellent.) The theory is that more complex binaries will be more likely to crash while being fuzzed. Crashes can then be analyzed to find new [0-day vulnerabilities](https://en.wikipedia.org/wiki/Zero-day_(computing)). So a smaller cyclomatic complexity value is better, and hopefully more "secure."

Check back for udates and more analysis.

## Sample results data

When the tool works right, here's a sample result, taken from [coreutils](fedora/27/c/coreutils-8.27-16.fc27.x86_64.rpm.json).

```json
{
    "results": {
            "_comment": "truncated to here",
            "filename": "usr/bin/ls", 
            "complexity": {
                "r2aa": {
                    "afCc": -1, 
                    "_comment": "this appears to be a bug, tracked at https://github.com/fedoraredteam/cyber-test-lab/issues/12",
                    "afC": 69
                }
            }, 
            "hardening-check": {
                " Read-only relocations": "yes", 
                " Position Independent Executable": "yes", 
                " Stack protected": "yes", 
                " Fortify Source functions": "yes (some protected functions found)", 
                " Immediate binding": "yes"
            }, 
            "report-functions": [
                "__xstat", 
                "__uflow", 
                "fdopen", 
                "__fprintf_chk", 
                "gettimeofday", 
                "getgrgid", 
                "calloc", 
                "fscanf", 
                "__freading", 
                "strtoul", 
                "snprintf", 
                "timegm", 
                "exit", 
                "sigaction", 
                "__fxstat", 
                "strcpy", 
                "iswcntrl", 
                "__cxa_atexit", 
                "fwrite", 
                "cap_get_file", 
                "strcoll", 
                "__ctype_get_mb_cur_max", 
                "getpwuid", 
                "fputs_unlocked", 
                "wcwidth", 
                "ioctl", 
                "_ITM_registerTMCloneTable", 
                "__libc_start_main", 
                "__overflow", 
                "free", 
                "mbsinit", 
                "cap_to_text", 
                "stpncpy", 
                "strcmp", 
                "__assert_fail", 
                "fclose", 
                "sigprocmask", 
                "setenv", 
                "fwrite_unlocked", 
                "close", 
                "strncmp", 
                "localeconv", 
                "opendir", 
                "open", 
                "fileno", 
                "__cxa_finalize", 
                "getxattr", 
                "wcstombs", 
                "isatty", 
                "iswprint", 
                "getenv", 
                "strchr", 
                "__ctype_toupper_loc", 
                "strrchr", 
                "memset", 
                "memcpy", 
                "closedir", 
                "__snprintf_chk", 
                "getfilecon", 
                "malloc", 
                "freecon", 
                "sigismember", 
                "__stack_chk_fail", 
                "__errno_location", 
                "__gmon_start__", 
                "readlink", 
                "tcgetpgrp", 
                "_ITM_deregisterTMCloneTable", 
                "nl_langinfo", 
                "fflush", 
                "cap_free", 
                "ungetc", 
                "gmtime_r", 
                "lseek", 
                "memcmp", 
                "setlocale", 
                "mbrtowc", 
                "fnmatch", 
                "__sprintf_chk", 
                "textdomain", 
                "wcswidth", 
                "_setjmp", 
                "strftime", 
                "strlen", 
                "__ctype_b_loc", 
                "bindtextdomain", 
                "raise", 
                "__lxstat", 
                "__strtoul_internal", 
                "sigaddset", 
                "_exit", 
                "clock_gettime", 
                "__fpending", 
                "lgetfilecon", 
                "tzset", 
                "__printf_chk", 
                "dirfd", 
                "localtime_r", 
                "getgrnam", 
                "getpwnam", 
                "realloc", 
                "abort", 
                "unsetenv", 
                "memmove", 
                "mbstowcs", 
                "dcgettext", 
                "signal", 
                "__ctype_tolower_loc", 
                "fgetfilecon", 
                "fseeko", 
                "sigemptyset", 
                "readdir", 
                "mempcpy", 
                "error", 
                "__memcpy_chk"
            ], 
            "rpm": "coreutils-8.27-16.fc27.x86_64.rpm"
        }, 
        "usr/bin/pwd": {
            "find-libc-functions": [
                "GI___obstack_vprintf", 
                "GI___vasprintf", 
                "GI___vdprintf", 
                "GI___vfprintf", 
                "GI___vfwprintf", 
                "GI___vsnprintf", 
                "GI___vsprintf", 
                "GI___vswprintf", 
                "GI___vsyslog", 
                "__longjmp", 
                "_fprintf", 
                "_printf", 
                "_snprintf", 
                "_sprintf", 
                "_vfprintf", 
                "_vprintf", 
                "_vsnprintf", 
                "_vsprintf", 
                "asprintf", 
                "confstr", 
                "dprintf", 
                "explicit_bzero", 
                "fdelt", 
                "fgets", 
                "fgets_unlocked", 
                "fgetws", 
                "fgetws_unlocked", 
                "fprintf", 
                "fread", 
                "fread_unlocked", 
                "fwprintf", 
                "getcwd", 
                "getdomainname", 
                "getgroups", 
                "gethostname", 
                "getlogin_r", 
                "gets", 
                "getwd", 
                "longjmp", 
                "mbsnrtowcs", 
                "mbsrtowcs", 
                "mbstowcs", 
                "memcpy", 
                "memmove", 
                "mempcpy", 
                "memset", 
                "obstack_printf", 
                "obstack_vprintf", 
                "poll", 
                "ppoll", 
                "pread64", 
                "pread", 
                "printf", 
                "ptsname_r", 
                "read", 
                "readlink", 
                "readlinkat", 
                "realpath", 
                "recv", 
                "recvfrom", 
                "snprintf", 
                "sprintf", 
                "stpcpy", 
                "stpncpy", 
                "strcat", 
                "strcpy", 
                "strncat", 
                "strncpy", 
                "swprintf", 
                "syslog", 
                "ttyname_r", 
                "vasprintf", 
                "vdprintf", 
                "vfprintf", 
                "vfwprintf", 
                "vprintf", 
                "vsnprintf", 
                "vsprintf", 
                "vswprintf", 
                "vsyslog", 
                "vwprintf", 
                "wcpcpy", 
                "wcpncpy", 
                "wcrtomb", 
                "wcscat", 
                "wcscpy", 
                "wcsncat", 
                "wcsncpy", 
                "wcsnrtombs", 
                "wcsrtombs", 
                "wcstombs", 
                "wctomb", 
                "wmemcpy", 
                "wmemmove", 
                "wmempcpy", 
                "wmemset", 
                "wprintf"
            ], 
            "filename": "usr/bin/pwd", 
            "complexity": {
                "r2aa": {
                    "afCc": 9, 
                    "afC": 198
                }
            }, 
            "hardening-check": {
                " Read-only relocations": "yes", 
                " Position Independent Executable": "yes", 
                " Stack protected": "yes", 
                " Fortify Source functions": "yes (some protected functions found)", 
                " Immediate binding": "yes"
            }, 
            "report-functions": [
                "getenv", 
                "textdomain", 
                "lseek", 
                "__printf_chk", 
                "strlen", 
                "calloc", 
                "__ctype_b_loc", 
                "strncmp", 
                "closedir", 
                "mbsinit", 
                "error", 
                "__fxstat", 
                "bindtextdomain", 
                "open", 
                "__xstat", 
                "fileno", 
                "free", 
                "_exit", 
                "fputs_unlocked", 
                "__errno_location", 
                "strcmp", 
                "readdir", 
                "iswprint", 
                "setlocale", 
                "close", 
                "_ITM_registerTMCloneTable", 
                "memcmp", 
                "__uflow", 
                "malloc", 
                "strrchr", 
                "mbrtowc", 
                "strstr", 
                "fscanf", 
                "__fpending", 
                "nl_langinfo", 
                "memcpy", 
                "fclose", 
                "__fprintf_chk", 
                "__libc_start_main", 
                "realloc", 
                "abort", 
                "ungetc", 
                "getopt_long", 
                "__gmon_start__", 
                "exit", 
                "_ITM_deregisterTMCloneTable", 
                "__cxa_finalize", 
                "__ctype_get_mb_cur_max", 
                "puts", 
                "chdir", 
                "__freading", 
                "dirfd", 
                "fwrite", 
                "getcwd", 
                "fchdir", 
                "memset", 
                "__lxstat", 
                "fdopen", 
                "fseeko", 
                "fflush", 
                "dcgettext", 
                "__cxa_atexit"
            ], 
            "rpm": "coreutils-8.27-16.fc27.x86_64.rpm"
        }, 
	{ "_comment": "truncated to end of file" },
    },
}
```
